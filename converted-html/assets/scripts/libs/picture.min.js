/**
 * jQuery Picture
 * http://jquerypicture.com
 * http://github.com/Abban/jQuery-Picture
 * 
 * May 2012
 * 
 * @version 0.9
 * @author Abban Dunne http://abandon.ie
 * @license MIT
 * 
 * jQuery Picture is a plugin to add support for responsive images to your layouts.
 * It supports both figure elements with some custom data attributes and the new
 * proposed picture format. This plugin will be made redundant when the format is
 * approved and implemented by browsers. Lets hope that happens soon. In the meantime
 * this plugin will be kept up to date with latest developments.
 * 
 */
!function(e){e.fn.picture=function(t){var a={container:null,ignorePixelRatio:!1},i=e.extend({},a,t);this.each(function(){function t(t){if(t)if("figure"==o.get(0).tagName.toLowerCase()){var d=o.data();e.each(d,function(e){var t;t=e.replace(/[^\d.]/g,""),t&&s.push(t)})}else o.find("source").each(function(){var t,a;t=e(this).attr("media"),t&&(a=t.replace(/[^\d.]/g,""),s.push(a))});var f=0;r=null==i.container?e(window).width()*l:e(i.container).width()*l,e.each(s,function(e,t){parseInt(r)>=parseInt(t)&&parseInt(f)<=parseInt(t)&&(f=t)}),c!==f&&(c=f,"figure"==o.get(0).tagName.toLowerCase()?n():a())}function a(){var t=new Object;if(o.find("source").each(function(){var a,i,n;a=e(this).attr("media"),i=e(this).attr("src"),n=a?a.replace(/[^\d.]/g,""):0,t[n]=i}),0==o.find("img").length){var a='<img src="'+t[c]+'" style="'+o.attr("style")+'" alt="'+o.attr("alt")+'">';0==e(">a",o).length?o.append(a):e(">a",o).append(a)}else o.find("img").attr("src",t[c])}function n(){var t=new Object,a=o.data();if(e.each(a,function(e,a){var i;i=e.replace(/[^\d.]/g,""),i||(i=0),t[i]=a}),0==o.find("img").length){var i='<img src="'+t[c]+'" alt="'+o.attr("title")+'">';0==e(">a",o).length?o.append(i):e(">a",o).append(i)}else o.find("img").attr("src",t[c])}var r,c,o,d,s=new Array,l=1;i.ignorePixelRatio||void 0===window.devicePixelRatio||(l=window.devicePixelRatio),o=e(this),t(!0),d=!1,e(window).resize(function(){d!==!1&&clearTimeout(d),d=setTimeout(t,200)})})}}(jQuery);